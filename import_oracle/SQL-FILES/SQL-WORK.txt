ALTER TABLESPACE RM_DADOS COALESCE;
ALTER TABLESPACE RM_INDICES COALESCE;

DECLARE
  V_INDEX VARCHAR(100);
  V_CMD VARCHAR(1000);
CURSOR TAB IS SELECT INDEX_NAME FROM USER_INDEXES;
BEGIN 
  OPEN TAB;
FETCH TAB INTO V_INDEX;
LOOP EXIT WHEN TAB%NOTFOUND;
V_CMD := 'ALTER INDEX ' || V_INDEX ||' REBUILD TABLESPACE RM_INDICES';
EXECUTE IMMEDIATE (V_CMD);
FETCH TAB INTO V_INDEX;
END LOOP;
CLOSE TAB;
END;
/

begin FOR cur IN (SELECT OBJECT_NAME, OBJECT_TYPE, owner FROM all_objects WHERE Owner = 'RM') LOOP 
BEGIN
  if cur.OBJECT_TYPE = 'PACKAGE BODY' then 
    EXECUTE IMMEDIATE 'alter ' || cur.OBJECT_TYPE || ' "' ||  cur.owner || '"."' || cur.OBJECT_NAME || '" compile body'; 
  else 
    EXECUTE IMMEDIATE 'alter ' || cur.OBJECT_TYPE || ' "' ||  cur.owner || '"."' || cur.OBJECT_NAME || '" compile'; 
  end if; 
EXCEPTION
  WHEN OTHERS THEN NULL; 
END;
end loop; end;
/
exit